(function(){function u(s,r,n){function d(o,e){if(!r[o]){if(!s[o]){var t="function"==typeof require&&require;if(!e&&t)return t(o,!0);if(a)return a(o,!0);var i=new Error("Cannot find module '"+o+"'");throw i.code="MODULE_NOT_FOUND",i}var l=r[o]={exports:{}};s[o][0].call(l.exports,function(e){var t=s[o][1][e];return d(t||e)},l,l.exports,u,s,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,e=0;e<n.length;e++)d(n[e]);return d}return u})()({1:[function(e,t,o){"use strict";var i=e("./modules/controller");var l=a(i);var s=e("./modules/model");var r=a(s);var n=e("./modules/view");var d=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var u=document.getElementById("poligon");var h=new r.default,m=new d.default({$elem:u}),c=new l.default(m,h);c.init()},{"./modules/controller":2,"./modules/model":3,"./modules/view":4}],2:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:true});var i=function(){function i(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,o){if(t)i(e.prototype,t);if(o)i(e,o);return e}}();function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=function(){function o(e,t){l(this,o);this.model=t;this.view=e;this.interval=null}i(o,[{key:"onTapMovement",value:function e(t){if(t.keyCode==this.model.KEY.LEFT&&this.model.dir!="right"){this.model.dir="left"}else if(t.keyCode==this.model.KEY.RIGHT&&this.model.dir!="left"){this.model.dir="right"}else if(t.keyCode==this.model.KEY.UP&&this.model.dir!="down"){this.model.dir="up"}else if(t.keyCode==this.model.KEY.DOWN&&this.model.dir!="up"){this.model.dir="down"}}},{key:"onClickReload",value:function e(t){this.view.clearMatrix();this.startGame()}},{key:"calculateRowsCols",value:function e(){this.model.cols=Math.floor(this.view.$elem.offsetWidth/this.model.matrix.y);this.model.rows=Math.floor(this.view.$elem.offsetHeight/this.model.matrix.x);this.view.addMatrix(this.model.cols,this.model.rows)}},{key:"randomInteger",value:function e(t,o){var i=t-.5+Math.random()*(o-t+1);return Math.round(i)}},{key:"getCellNode",value:function e(t,o){var i=(t-1)*this.model.cols+o-1;return this.view.$elem.querySelectorAll(".cell")[i]}},{key:"getCellSnake",value:function e(t,o){var i=this.getCellNode(t,o);if(i&&i.classList.contains("snake")){return true}else{return false}}},{key:"getFood",value:function e(t,o){var i=this.getCellNode(t,o);if(i&&i.classList.contains("food")){this.view.removeFood(i);return true}else{return false}}},{key:"createFood",value:function e(){this.model.foodRow=this.randomInteger(1,this.model.rows);this.model.foodCol=this.randomInteger(1,this.model.cols);if(!this.getCellSnake(this.model.foodRow,this.model.foodCol)){this.setFood(this.model.foodRow,this.model.foodCol)}else{this.createFood()}}},{key:"setCellSnake",value:function e(t,o){var i=this.getCellNode(t,o);this.view.drawSnake(i)}},{key:"setFood",value:function e(t,o){var i="";if(this.getCellSnake(t,o)){i=this.getCellNode(this.randomInteger(1,this.model.rows),this.randomInteger(1,this.model.cols))}else{i=this.getCellNode(t,o)}this.view.drawFood(i)}},{key:"move",value:function e(t){switch(this.model.dir){case"left":if(t.col<=1){this.model.body[0].y=this.model.cols}else{this.model.body[0].y=this.model.body[1].y-1}this.model.body[0].x=this.model.body[1].x;break;case"right":if(t.col>=this.model.cols){this.model.body[0].y=1}else{this.model.body[0].y=this.model.body[1].y+1}this.model.body[0].x=this.model.body[1].x;break;case"up":if(t.row<=1){this.model.body[0].x=this.model.rows}else{this.model.body[0].x=this.model.body[1].x-1}this.model.body[0].y=this.model.body[1].y;break;case"down":if(t.row>=this.model.rows){this.model.body[0].x=1}else{this.model.body[0].x=this.model.body[1].x+1}this.model.body[0].y=this.model.body[1].y;break;default:console.log("default")}}},{key:"moveSnake",value:function e(){this.model.body.unshift({});var t=this.serialNumber();this.move(t)}},{key:"serialNumber",value:function e(){var t=this.getCellNode(this.model.body[1].x,this.model.body[1].y);return{row:t.getAttribute("data-row"),col:t.getAttribute("data-column")}}},{key:"gameOver",value:function e(){var t=this.getCellNode(this.model.body[1].x,this.model.body[1].y);this.view.gameOver(t);clearInterval(this.interval);this.view.onClickReload=this.onClickReload.bind(this);this.view.addRelaodBtn()}},{key:"gamePlay",value:function e(){var t=this;this.interval=setTimeout(function(){t.moveSnake();if(!t.getFood(t.model.body[0].x,t.model.body[0].y)){t.setCellSnake(t.model.body[t.model.body.length-1].x,t.model.body[t.model.body.length-1].y);t.model.body.pop()}else{t.model.playscore++;t.view.addPlayscore(t.model.playscore);t.model.interval=t.model.interval<=54?t.model.interval:t.model.interval-t.model.stepSpeed;t.createFood()}if(t.getCellSnake(t.model.body[0].x,t.model.body[0].y)){t.gameOver();return}t.setCellSnake(t.model.body[0].x,t.model.body[0].y);t.gamePlay()},t.model.interval)}},{key:"startGame",value:function e(){this.model.body=[{x:1,y:3},{x:1,y:2},{x:1,y:1}];this.model.dir="right";this.model.interval=350;this.model.playscore=0;this.setCellSnake(this.model.body[0].x,this.model.body[0].y);this.setCellSnake(this.model.body[1].x,this.model.body[1].y);this.setCellSnake(this.model.body[2].x,this.model.body[2].y);this.gamePlay();this.createFood()}},{key:"init",value:function e(){this.view.onTapMovement=this.onTapMovement.bind(this);this.calculateRowsCols();this.startGame()}}]);return o}();o.default=s},{}],3:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:true});function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=function e(t){i(this,e);this.interval=350;this.playscore=0;this.body=[{x:1,y:3},{x:1,y:2},{x:1,y:1}];this.dir="right";this.rows=0;this.cols=0;this.stepSpeed=15;this.matrix={x:20,y:20};this.foodRow=0;this.foodCol=0;this.KEY={LEFT:37,RIGHT:39,UP:38,DOWN:40}};o.default=l},{}],4:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:true});var i=function(){function i(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,o){if(t)i(e.prototype,t);if(o)i(e,o);return e}}();function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=function(){function t(e){l(this,t);this.$elem=e.$elem;this.onTapMovement=null;this.onClickReload=null}i(t,[{key:"addMatrix",value:function e(t,o){for(var i=1;i<=t;i++){for(var l=1;l<=o;l++){var s=document.createElement("div");s.classList.add("cell");s.setAttribute("data-row",i);s.setAttribute("data-column",l);this.$elem.appendChild(s)}}this.insert()}},{key:"drawSnake",value:function e(t){t.classList.toggle("snake")}},{key:"drawFood",value:function e(t){t.classList.toggle("food")}},{key:"addRelaodBtn",value:function e(){var t=document.createElement("a");t.classList.add("btn");t.innerText="Начать сначала!";this.$elem.appendChild(t);t.addEventListener("click",this.onClickReload)}},{key:"removeFood",value:function e(t){t.classList.remove("food")}},{key:"gameOver",value:function e(t){t.classList.add("snake-error-head")}},{key:"addPlayscore",value:function e(t){var o=this.$elem.querySelector(".score");if(!o){var i=document.createElement("span");i.classList.add("score");i.innerText="Результат:"+t;this.$elem.appendChild(i)}else{o.innerText="Результат:"+t}}},{key:"clearMatrix",value:function e(){var t=this.$elem.querySelectorAll(".cell");var o=this.$elem.querySelector(".btn");var i=this.$elem.querySelector(".score");for(var l=0;l<t.length;l++){var s=t[l];if(s.classList.contains("snake")||s.classList.contains("food")){s.classList.remove("snake","food","snake-error-head")}}i.remove();o.remove()}},{key:"insert",value:function e(){document.addEventListener("keyup",this.onTapMovement)}}]);return t}();o.default=s},{}]},{},[1]);
//# sourceMappingURL=main.bundle.js.map
